<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Emoji Game Setup</title>
<style>
body { font-family:sans-serif; text-align:center; margin:10px; }
input, button { font-size:16px; margin:5px; padding:5px; }
textarea {
  font-size:16px; margin:5px; padding:5px; width:250px; height:120px; resize:none;
  border:1px solid #ccc; border-radius:5px;
  background: repeating-linear-gradient(
    to bottom,
    #fff,
    #fff 28px,
    #ccc 28px,
    #ccc 30px
  );
  line-height:30px;
}
button { cursor:pointer; }
</style>
</head>
<body>

<h2>‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏Å‡∏° Emoji</h2>
<label>Category: <input id="categoryInput" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà"></label><br>
<label>Correct Words (one per line):</label><br>
<textarea id="correctInput"></textarea><br>
<label>Wrong Words (one per line):</label><br>
<textarea id="wrongInput"></textarea><br>
<button onclick="saveConfig()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å & ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏Å‡∏°</button>

<script>
let emojiData = null;

// ‡πÇ‡∏´‡∏•‡∏î emoji database
async function loadEmojiData() {
  if(!emojiData){
    const res = await fetch('emoji.json');
    emojiData = await res.json();
  }
}

// ‡πÇ‡∏´‡∏•‡∏î config ‡πÄ‡∏Å‡πà‡∏≤‡∏ñ‡πâ‡∏≤‡∏°‡∏µ
const savedConfig = JSON.parse(localStorage.getItem('emojiGameConfig')||'{}');
if(savedConfig.categoryName) document.getElementById('categoryInput').value = savedConfig.categoryName;
if(savedConfig.correct) document.getElementById('correctInput').value = savedConfig.correct.join('\n');
if(savedConfig.wrong) document.getElementById('wrongInput').value = savedConfig.wrong.join('\n');

async function saveConfig(){
  await loadEmojiData();

  const category = document.getElementById('categoryInput').value.trim();
  const correct = document.getElementById('correctInput').value.split('\n').map(s=>s.trim()).filter(s=>s);
  const wrong = document.getElementById('wrongInput').value.split('\n').map(s=>s.trim()).filter(s=>s);

  if(!category){ alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà"); return; }
  if(correct.length===0){ alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡∏Ñ‡∏≥"); return; }

  // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö emoji (case-insensitive ‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡∏î‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏ó‡πâ‡∏≤‡∏¢)
  let missing = [];
  [...correct,...wrong].forEach(word=>{
    const w = word.toLowerCase().trim();
    const found = emojiData.find(e =>
      e.short_names.some(sn => sn.toLowerCase().replace(/\d+$/, '') === w)
    );
    if(!found) missing.push(word);
  });

  if(missing.length > 0){
    alert("‡∏Ñ‡∏≥‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏°‡∏µ emoji: " + missing.join(', '));
    return;
  }

  // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å config
  const config = {categoryName:category, correct, wrong};
  localStorage.setItem('emojiGameConfig', JSON.stringify(config));

  // ‡πÄ‡∏î‡πâ‡∏á‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏Å‡∏°
  window.location.href='game.html';
}
</script>

</body>
</html>
